
clear all; close all; clc;


% WP = [ ...
% 36.10362595779492 129.3918278934956 ;
% % 36.10362611972684 129.39184221988484 ;
% % 36.103654625882036 129.39178311751363 ;
% 36.10373973029286 129.39141494987485 ;
% 36.103734729986734 129.39134664628026 ;
% % 36.103725644183005 129.39132241366384 ;
% 36.10368821586895 129.39130434320447 ;
% 36.10364962618149 129.39130900261876 ;
% 36.10362320297809 129.39135798738477 ;
% 36.10350984833106 129.39177168367383 ;
% ];

WP = [ ...
37.23907292	126.77310065;
37.23908107	126.77312476;

37.23910426	126.77311989;
37.23911174	126.77314393;

37.23913473	126.77313942;
37.23914271	126.77316579;

37.23921325	126.77317307;
37.23920047	126.77320326;

37.23923212	126.77318980;
37.23921967	126.77321898;

37.23925136	126.77320397;
37.23923982	126.77323185;

37.23926998	126.77322075;
37.23925989	126.77324386;

37.23932665	126.77326036;
37.23932910	126.77329321;

37.23935475	126.77327487;
37.23935441	126.77330359;

37.23937582	126.77328437;
37.23937758	126.77331873;

37.23940126	126.77330609;
37.23940166	126.77333672;

37.23942381	126.77332195;
37.23942494	126.77335036;

37.23944791	126.77333786;
37.23944828	126.77336497;
];


for i = 1 : size(WP,1)-1
    heading_angle(i) = azimuth('rh', WP(i,1), WP(i,2), WP(i+1,1), WP(i+1,2));
    if heading_angle(i) > 180.0
        heading_angle(i) = heading_angle(i) - 360;
    end
end
heading_angle(size(WP,1)) = 0.0;
heading_angle = heading_angle';

% hold on;
geoplot_with_index(WP, 'g*-', 2, 'Waypoints 2022' )
n = 1;
WP_OFFSET =[ 37.2391424623079   126.773174084310 ];

OFFSET = [ WP(6,1) - WP_OFFSET(1,1)   WP(6,2) - WP_OFFSET(1,2) ];
WP_NEW(:,1) = WP(:,1) - OFFSET(1,1);
WP_NEW(:,2) = WP(:,2) - OFFSET(1,2);
hold on;
geoplot_with_index(WP_NEW, 'b*-', 2, 'Waypoints 2022' )



WP = [WP heading_angle];

%% WRITE CSV FILE

dt = datestr(now,'mm-dd,HHMM');
filename = strcat('data/WP_', dt, '.csv');
writematrix(WP, filename)